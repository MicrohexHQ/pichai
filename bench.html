<!--Test bench code for webduino.
    
    This file is part of webduino.
    
    webduino is free software; you can redistribute it and/or modify it under
    the terms of the GNU General Public License as published by the Free
    Software Foundation; either version 3, or (at your option) any later
    version.
    
    webduino is distributed in the hope that it will be useful, but WITHOUT ANY
    WARRANTY; without even the implied warranty of MERCHANTABILITY or
    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
    for more details.
    
    You should have received a copy of the GNU General Public License
    along with webduino; see the file LICENSE.  If not see
    <http://www.gnu.org/licenses/>-->
<html>  
    <script type="text/javascript" src="js/avrcore.js"></script>
    <div>
    <input type="file" id="hexfile"/>
    <br/>
    <span class="loadMemory">
      <button>Load Memory</button>
    </span>
    <button onClick="exec()">Continue</button>
    </div>
    <div style="width: 25%; display: table;">
        <div style="display: table-row">
            <div style="display: table-cell;">  <canvas id="led0" width="10" height="10"/> </div>
            <div style="display: table-cell;">  <canvas id="led1" width="10" height="10"/> </div>
            <div style="display: table-cell;">  <canvas id="led2" width="10" height="10"/> </div>
            <div style="display: table-cell;">  <canvas id="led3" width="10" height="10"/> </div>
            <div style="display: table-cell;">  <canvas id="led4" width="10" height="10"/> </div>
            <div style="display: table-cell;">  <canvas id="led5" width="10" height="10"/> </div>
            <div style="display: table-cell;">  <canvas id="led6" width="10" height="10"/> </div>
            <div style="display: table-cell;">  <canvas id="led7" width="10" height="10"/> </div>
        </div>
    </div>
    <script>
      fillLED("led0", "#FF0000");
      fillLED("led1", "#FF0000");
      fillLED("led2", "#FF0000");
      fillLED("led3", "#FF0000");
      fillLED("led4", "#FF0000");
      fillLED("led5", "#FF0000");
      fillLED("led6", "#FF0000");
      fillLED("led7", "#FF0000");

      document.querySelector('.loadMemory').addEventListener('click', function(evt) {
        var file = document.getElementById('hexfile').files[0];
        if (!file) {
          alert('Intel Hex File Required');
          return;
        }
  
        var reader = new FileReader();
        reader.onloadend = function(evt) {
          if (evt.target.readyState == FileReader.DONE) {
              loadMemory(evt.target.result);
              engineInit();
              exec();
          }
        };
    
        reader.readAsBinaryString(file.slice(0, file.size));
      }, false);
    </script>
</html>
